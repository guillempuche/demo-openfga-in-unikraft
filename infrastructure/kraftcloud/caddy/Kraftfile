spec: v0.6

name: openfga-caddy

runtime: base-compat:latest

labels:
  cloud.unikraft.v1.instances/scale_to_zero.policy: "on"
  cloud.unikraft.v1.instances/scale_to_zero.stateful: "false"
  cloud.unikraft.v1.instances/scale_to_zero.cooldown_time_ms: 1000

rootfs: ./Dockerfile.caddy

cmd: ["/usr/bin/caddy", "run", "--config", "/etc/caddy/Caddyfile"]

env:
  CADDY_CONTACT_EMAIL: ${CADDY_CONTACT_EMAIL:-}
  OPENFGA_API_HOST: ${OPENFGA_API_HOST:-}
  OPENFGA_PLAYGROUND_HOST: ${OPENFGA_PLAYGROUND_HOST:-}
  OPENFGA_UPSTREAM_HOST: ${OPENFGA_UPSTREAM_HOST:-openfga}
  OPENFGA_UPSTREAM_PORT: ${OPENFGA_UPSTREAM_PORT:-8080}
  OPENFGA_PLAYGROUND_UPSTREAM_PORT: ${OPENFGA_PLAYGROUND_UPSTREAM_PORT:-3000}
  CADDY_GLOBAL_OPTIONS: ${CADDY_GLOBAL_OPTIONS:-}
  CADDY_API_BLOCK_DIRECTIVES: ${CADDY_API_BLOCK_DIRECTIVES:-}
  CADDY_PLAYGROUND_BLOCK_DIRECTIVES: ${CADDY_PLAYGROUND_BLOCK_DIRECTIVES:-}
