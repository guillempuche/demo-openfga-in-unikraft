spec: v0.6

name: openfga-server

runtime: base-compat:latest

labels:
  cloud.unikraft.v1.instances/scale_to_zero.policy: "on"
  cloud.unikraft.v1.instances/scale_to_zero.stateful: "false"
  cloud.unikraft.v1.instances/scale_to_zero.cooldown_time_ms: 1000

rootfs: ./Dockerfile.openfga

cmd: ["/usr/bin/openfga", "run"]

env:
  OPENFGA_DATASTORE_ENGINE: ${OPENFGA_DATASTORE_ENGINE:-postgres}
  OPENFGA_DATASTORE_URI: ${OPENFGA_DATASTORE_URI:-}
  OPENFGA_ACCESS_CONTROL_STORE_ID: ${OPENFGA_ACCESS_CONTROL_STORE_ID:-}
  OPENFGA_AUTHN_PRESHARED_KEYS: ${OPENFGA_AUTHN_PRESHARED_KEYS:-}
  OPENFGA_HTTP_LISTEN_ADDR: ${OPENFGA_HTTP_LISTEN_ADDR:-0.0.0.0}
  OPENFGA_HTTP_LISTEN_PORT: ${OPENFGA_HTTP_LISTEN_PORT:-8080}
  OPENFGA_HTTP_TLS_ENABLED: ${OPENFGA_HTTP_TLS_ENABLED:-false}
  OPENFGA_HTTP_CORS_ALLOWED_ORIGINS: ${OPENFGA_HTTP_CORS_ALLOWED_ORIGINS:-*}
  OPENFGA_HTTP_CORS_ALLOWED_HEADERS: ${OPENFGA_HTTP_CORS_ALLOWED_HEADERS:-Content-Type,Authorization}
  OPENFGA_LOG_LEVEL: ${OPENFGA_LOG_LEVEL:-info}
  OPENFGA_LOG_FORMAT: ${OPENFGA_LOG_FORMAT:-json}
  OPENFGA_PLAYGROUND_ENABLED: ${OPENFGA_PLAYGROUND_ENABLED:-true}
  OPENFGA_PLAYGROUND_PORT: ${OPENFGA_PLAYGROUND_PORT:-3000}
